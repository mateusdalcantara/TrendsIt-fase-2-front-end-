<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TrendsIT - Calendar</title>
    
    <!-- CSS Links -->
    <link rel="stylesheet" href="css/style.css">
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="css/calendar.css">
  </head>
<body>
    <script>
        // Authentication check
        if (!localStorage.getItem('token')) {
            window.location.href = 'index.html';
        }
    </script>

    <nav class="main-nav">
        <div class="brand">TrendsIT</div>
        <div class="nav-links">
            <button id="logoutBtn">Logout</button>
            <button id="profileBtn"><i class="fas fa-user"></i></button>
        </div>
    </nav>

    <main class="container">
        <aside class="sidebar">
            <nav>
                <ul>
                    <li><a href="home.html"><i class="fas fa-home"></i> Feed</a></li>
                    <li><a href="directory.html"><i class="fas fa-users"></i> Directory</a></li>
                    <li><a href="groups.html"><i class="fas fa-user-friends"></i> Groups</a></li>
                    <li><a href="calendar.html" class="active"><i class="fas fa-calendar-alt"></i> Calendar</a></li>
                    <li><a href="jobs.html"><i class="fas fa-briefcase"></i> Jobs</a></li>
                </ul>
            </nav>
        </aside>

        <section class="content">
            <div id="calendar"></div>
        </section>
    </main>

    <!-- Event Details Modal -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <h3 id="eventTitle"></h3>
            <p id="eventDescription"></p>
            <div class="event-meta">
                <span id="eventDate"></span>
                <span id="eventLocation"></span>
            </div>
            <button class="btn-primary" onclick="document.getElementById('eventModal').style.display = 'none'">
                Close
            </button>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    
    <!-- Application Scripts -->
    <script src="js/api.js"></script>
    <script>
        // Calendar Initialization
        document.addEventListener('DOMContentLoaded', () => {
            const calendarEl = document.getElementById('calendar');
            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                events: '/api/events',
                eventClick: function(info) {
                    showEventModal(info.event);
                }
            });
            calendar.render();
        });

        // Event Modal Handler
        function showEventModal(event) {
            document.getElementById('eventTitle').textContent = event.title;
            document.getElementById('eventDescription').textContent = event.extendedProps.description;
            document.getElementById('eventDate').textContent = new Date(event.start).toLocaleString();
            document.getElementById('eventModal').style.display = 'flex';
        }

        // Logout Handler
        document.getElementById('logoutBtn').addEventListener('click', () => {
            localStorage.removeItem('token');
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>